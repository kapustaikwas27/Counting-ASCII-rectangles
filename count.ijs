g=:1&{::
f=:4 :0
p=.;@(<@(>&0(</@>#])@,@{@;~@#<:);._1)@(#\0&,@:*e.&'+'-e.&'-')x
l=.*./~@(e.&'+|')x
((+/@,@(p{g)+&.>0&{),l<@:*(]+1 p}0:"0)@g)y
)
":@(]0&{::F..f~0;0$~2#{:@$)@((('|-',a.){~('-|',a.)&i.)@|:^:(</@$))@(];._2)@(,&LF)&.stdin''
